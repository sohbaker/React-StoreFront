{"ast":null,"code":"import _classCallCheck from \"/Users/ellehallal/Documents/week-17/React-StoreFront/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/Users/ellehallal/Documents/week-17/React-StoreFront/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"/Users/ellehallal/Documents/week-17/React-StoreFront/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/Users/ellehallal/Documents/week-17/React-StoreFront/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"/Users/ellehallal/Documents/week-17/React-StoreFront/node_modules/@babel/runtime/helpers/esm/inherits\";\nvar _jsxFileName = \"/Users/ellehallal/Documents/week-17/React-StoreFront/src/components/Cart.js\";\nimport React from \"react\";\nimport CartItem from \"./CartItem\";\nimport \"./Cart.css\";\n\nvar Cart =\n/*#__PURE__*/\nfunction (_React$Component) {\n  _inherits(Cart, _React$Component);\n\n  function Cart(props) {\n    var _this;\n\n    _classCallCheck(this, Cart);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(Cart).call(this, props));\n\n    _this.getData = function () {\n      var dataToShow = [];\n      var data = _this.props.data;\n      data.forEach(function (data) {\n        if (data.cart_quantity > 0) {\n          dataToShow.push({\n            key: data.id,\n            id: data.id,\n            image: data.image,\n            name: data.name,\n            price: data.price,\n            category: data.category,\n            shop_quantity: data.shop_quantity,\n            cart_quantity: data.cart_quantity\n          });\n        } else {\n          return null;\n        }\n      });\n      return dataToShow;\n    };\n\n    _this.doesCartContainFootwear = function () {\n      var data = _this.getData();\n\n      var containsFootwear = false;\n      data.forEach(function (item) {\n        var itemCategory = item.category;\n\n        if (itemCategory.includes(\"Footwear\")) {\n          containsFootwear = true;\n        }\n      });\n      return containsFootwear;\n    };\n\n    _this.calculateSubtotal = function () {\n      var data = _this.getData();\n\n      if (data.length === 0) {\n        return null;\n      }\n\n      var orderTotal = [];\n      data.forEach(function (data) {\n        orderTotal.push(data.price * data.cart_quantity);\n      });\n      var subtotal = orderTotal.reduce(function (total, price) {\n        return total + price;\n      });\n      return subtotal.toFixed(2);\n    };\n\n    _this.areDiscountConditionsMet = function () {\n      var subtotal = _this.calculateSubtotal();\n\n      var five = _this.state.userDiscountCode === \"5OFF\";\n      var ten = _this.state.userDiscountCode === \"10OFF50\" && subtotal > 50;\n\n      var fifteen = _this.state.userDiscountCode === \"15OFF75\" && subtotal > 75 && _this.doesCartContainFootwear();\n\n      if (five || ten || fifteen) {\n        return true;\n      }\n\n      return false;\n    };\n\n    _this.displayDiscountInfo = function () {\n      var discountInfo = React.createElement(\"p\", {\n        id: \"discount-info\"\n      }, \"Discount value: £0\");\n\n      if (_this.areDiscountConditionsMet()) {\n        discountInfo = React.createElement(\"p\", {\n          id: \"discount-info\"\n        }, \"Discount value: £\" + _this.getCodeValue());\n      }\n\n      return discountInfo;\n    };\n\n    _this.getCodeValue = function () {\n      if (_this.isCodeValid()) {\n        var discountCodes = _this.state.discountCodes;\n        var discountValue = discountCodes[_this.state.userDiscountCode];\n        return discountValue.toFixed(2);\n      }\n\n      return 0;\n    };\n\n    _this.isCodeValid = function () {\n      var userCode = _this.state.userDiscountCode;\n      var discountCodes = _this.state.discountCodes;\n      return discountCodes.hasOwnProperty(userCode);\n    };\n\n    _this.calculateOrderTotal = function () {\n      var subtotal = _this.calculateSubtotal();\n\n      if (_this.areDiscountConditionsMet()) {\n        _this.displayDiscountInfo();\n\n        return (subtotal - _this.getCodeValue()).toFixed(2);\n      }\n\n      return subtotal;\n    };\n\n    _this.handleInputChange = function (event) {\n      _this.setState({\n        userDiscountCode: event.target.value\n      });\n    };\n\n    _this.handleFormSubmit = function (event) {\n      event.preventDefault();\n    };\n\n    _this.handleCheckoutClick = function (event) {\n      alert(\"Thanks for ordering from Nutmeg! Your items will be with you soon\");\n    };\n\n    _this.displayDiscountMessage = function () {\n      if (_this.state.userDiscountCode === null || _this.state.userDiscountCode === \"\") {\n        return;\n      }\n\n      var node = _this.discountMessage.current;\n\n      if (_this.areDiscountConditionsMet()) {\n        node.setAttribute(\"class\", \"ui success message\");\n\n        var _message = React.createElement(\"p\", {\n          id: \"success\"\n        }, \"Success! Your code has been applied\");\n\n        return _message;\n      }\n\n      node.setAttribute(\"class\", \"ui error message\");\n      var message = React.createElement(\"p\", {\n        id: \"error\"\n      }, \"Invalid discount code or conditions not met. Please try again\");\n      return message;\n    };\n\n    _this.state = {\n      userDiscountCode: null,\n      discountCodes: {\n        \"5OFF\": 5.0,\n        \"10OFF50\": 10.0,\n        \"15OFF75\": 15.0\n      }\n    };\n    _this.discountMessage = React.createRef();\n    _this.textInput = React.createRef();\n    _this.discountValue = React.createRef();\n    return _this;\n  }\n\n  _createClass(Cart, [{\n    key: \"componentDidUpdate\",\n    value: function componentDidUpdate() {\n      this.displayDiscountMessage();\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this2 = this;\n\n      var data = this.getData();\n      var displayCartItems;\n\n      if (!data) {\n        displayCartItems = null;\n      } else {\n        displayCartItems = data.map(function (item) {\n          return React.createElement(\"div\", {\n            className: \"cart-items\",\n            key: item.id,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 186\n            },\n            __self: this\n          }, React.createElement(CartItem, {\n            key: item.id,\n            id: item.id,\n            image: item.image,\n            name: item.name,\n            price: item.price,\n            shop_quantity: item.shop_quantity,\n            cart_quantity: item.cart_quantity,\n            onIncrement: function onIncrement(id) {\n              return _this2.props.onIncrement(item.id);\n            },\n            onDecrement: function onDecrement(id) {\n              return _this2.props.onDecrement(item.id);\n            },\n            onRemove: function onRemove(id) {\n              return _this2.props.onRemove(item.id);\n            },\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 187\n            },\n            __self: this\n          }));\n        });\n      }\n\n      return React.createElement(\"div\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 204\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: \"cart-header\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 205\n        },\n        __self: this\n      }, React.createElement(\"p\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 206\n        },\n        __self: this\n      }, React.createElement(\"span\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 207\n        },\n        __self: this\n      }, React.createElement(\"i\", {\n        className: \"shop icon small\",\n        test: \"icon-image\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 208\n        },\n        __self: this\n      })), \"Shopping Cart\")), React.createElement(\"div\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 213\n        },\n        __self: this\n      }, displayCartItems), React.createElement(\"div\", {\n        className: \"total-for-cart\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 214\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: \"cart-total-text\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 215\n        },\n        __self: this\n      }, React.createElement(\"hr\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 216\n        },\n        __self: this\n      }), React.createElement(\"div\", {\n        test: \"subtotal\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 217\n        },\n        __self: this\n      }, \"Subtotal: £\" + this.calculateSubtotal()), React.createElement(\"div\", {\n        test: \"discount-value\",\n        ref: this.discountValue,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 220\n        },\n        __self: this\n      }, this.displayDiscountInfo())), React.createElement(\"div\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 224\n        },\n        __self: this\n      }, React.createElement(\"form\", {\n        className: \"ui form\",\n        onSubmit: this.handleFormSubmit,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 225\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: \"inline field\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 226\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: \"inline fields\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 227\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: \"field\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 228\n        },\n        __self: this\n      }, React.createElement(\"input\", {\n        type: \"text\",\n        name: \"discount-code\",\n        placeholder: \"Discount code\",\n        test: \"discount-code\",\n        onChange: this.handleInputChange,\n        ref: this.textInput,\n        required: true,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 229\n        },\n        __self: this\n      })), React.createElement(\"div\", {\n        className: \"field button-field\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 239\n        },\n        __self: this\n      }, React.createElement(\"button\", {\n        className: \"ui button\",\n        type: \"submit\",\n        test: \"submit\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 240\n        },\n        __self: this\n      }, \"Submit\"))))), React.createElement(\"div\", {\n        className: \"discount-message\",\n        ref: this.discountMessage,\n        test: \"alert\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 247\n        },\n        __self: this\n      }, this.displayDiscountMessage()), React.createElement(\"div\", {\n        test: \"order-total\",\n        className: \"order-total\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 254\n        },\n        __self: this\n      }, \"Order total: £\" + this.calculateOrderTotal()), React.createElement(\"button\", {\n        className: \"ui yellow right floated button checkout-button\",\n        type: \"button\",\n        onClick: this.handleCheckoutClick,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 257\n        },\n        __self: this\n      }, \"PROCEED TO CHECKOUT\"))));\n    }\n  }]);\n\n  return Cart;\n}(React.Component);\n\nexport { Cart as default };","map":{"version":3,"sources":["/Users/ellehallal/Documents/week-17/React-StoreFront/src/components/Cart.js"],"names":["React","CartItem","Cart","props","getData","dataToShow","data","forEach","cart_quantity","push","key","id","image","name","price","category","shop_quantity","doesCartContainFootwear","containsFootwear","item","itemCategory","includes","calculateSubtotal","length","orderTotal","subtotal","reduce","total","toFixed","areDiscountConditionsMet","five","state","userDiscountCode","ten","fifteen","displayDiscountInfo","discountInfo","createElement","getCodeValue","isCodeValid","discountCodes","discountValue","userCode","hasOwnProperty","calculateOrderTotal","handleInputChange","event","setState","target","value","handleFormSubmit","preventDefault","handleCheckoutClick","alert","displayDiscountMessage","node","discountMessage","current","setAttribute","message","createRef","textInput","displayCartItems","map","onIncrement","onDecrement","onRemove","Component"],"mappings":";;;;;;AAAA,OAAOA,KAAP,MAAkB,OAAlB;AACA,OAAOC,QAAP,MAAqB,YAArB;AACA,OAAO,YAAP;;IAEqBC,I;;;;;AACnB,gBAAYC,KAAZ,EAAmB;AAAA;;AAAA;;AACjB,8EAAMA,KAAN;;AADiB,UAmBnBC,OAnBmB,GAmBT,YAAM;AACd,UAAIC,UAAU,GAAG,EAAjB;AACA,UAAMC,IAAI,GAAG,MAAKH,KAAL,CAAWG,IAAxB;AACAA,MAAAA,IAAI,CAACC,OAAL,CAAa,UAAAD,IAAI,EAAI;AACnB,YAAIA,IAAI,CAACE,aAAL,GAAqB,CAAzB,EAA4B;AAC1BH,UAAAA,UAAU,CAACI,IAAX,CAAgB;AACdC,YAAAA,GAAG,EAAEJ,IAAI,CAACK,EADI;AAEdA,YAAAA,EAAE,EAAEL,IAAI,CAACK,EAFK;AAGdC,YAAAA,KAAK,EAAEN,IAAI,CAACM,KAHE;AAIdC,YAAAA,IAAI,EAAEP,IAAI,CAACO,IAJG;AAKdC,YAAAA,KAAK,EAAER,IAAI,CAACQ,KALE;AAMdC,YAAAA,QAAQ,EAAET,IAAI,CAACS,QAND;AAOdC,YAAAA,aAAa,EAAEV,IAAI,CAACU,aAPN;AAQdR,YAAAA,aAAa,EAAEF,IAAI,CAACE;AARN,WAAhB;AAUD,SAXD,MAWO;AACL,iBAAO,IAAP;AACD;AACF,OAfD;AAgBA,aAAOH,UAAP;AACD,KAvCkB;;AAAA,UAyCnBY,uBAzCmB,GAyCO,YAAM;AAC9B,UAAMX,IAAI,GAAG,MAAKF,OAAL,EAAb;;AACA,UAAIc,gBAAgB,GAAG,KAAvB;AAEAZ,MAAAA,IAAI,CAACC,OAAL,CAAa,UAAAY,IAAI,EAAI;AACnB,YAAIC,YAAY,GAAGD,IAAI,CAACJ,QAAxB;;AAEA,YAAIK,YAAY,CAACC,QAAb,CAAsB,UAAtB,CAAJ,EAAuC;AACrCH,UAAAA,gBAAgB,GAAG,IAAnB;AACD;AACF,OAND;AAOA,aAAOA,gBAAP;AACD,KArDkB;;AAAA,UAuDnBI,iBAvDmB,GAuDC,YAAM;AACxB,UAAMhB,IAAI,GAAG,MAAKF,OAAL,EAAb;;AACA,UAAIE,IAAI,CAACiB,MAAL,KAAgB,CAApB,EAAuB;AACrB,eAAO,IAAP;AACD;;AACD,UAAMC,UAAU,GAAG,EAAnB;AACAlB,MAAAA,IAAI,CAACC,OAAL,CAAa,UAAAD,IAAI,EAAI;AACnBkB,QAAAA,UAAU,CAACf,IAAX,CAAgBH,IAAI,CAACQ,KAAL,GAAaR,IAAI,CAACE,aAAlC;AACD,OAFD;AAGA,UAAMiB,QAAQ,GAAGD,UAAU,CAACE,MAAX,CAAkB,UAACC,KAAD,EAAQb,KAAR;AAAA,eAAkBa,KAAK,GAAGb,KAA1B;AAAA,OAAlB,CAAjB;AACA,aAAOW,QAAQ,CAACG,OAAT,CAAiB,CAAjB,CAAP;AACD,KAlEkB;;AAAA,UAoEnBC,wBApEmB,GAoEQ,YAAM;AAC/B,UAAMJ,QAAQ,GAAG,MAAKH,iBAAL,EAAjB;;AACA,UAAMQ,IAAI,GAAG,MAAKC,KAAL,CAAWC,gBAAX,KAAgC,MAA7C;AACA,UAAMC,GAAG,GAAG,MAAKF,KAAL,CAAWC,gBAAX,KAAgC,SAAhC,IAA6CP,QAAQ,GAAG,EAApE;;AACA,UAAMS,OAAO,GACX,MAAKH,KAAL,CAAWC,gBAAX,KAAgC,SAAhC,IACAP,QAAQ,GAAG,EADX,IAEA,MAAKR,uBAAL,EAHF;;AAIA,UAAIa,IAAI,IAAIG,GAAR,IAAeC,OAAnB,EAA4B;AAC1B,eAAO,IAAP;AACD;;AACD,aAAO,KAAP;AACD,KAhFkB;;AAAA,UAkFnBC,mBAlFmB,GAkFG,YAAM;AAC1B,UAAIC,YAAY,GAAGpC,KAAK,CAACqC,aAAN,CACjB,GADiB,EAEjB;AAAE1B,QAAAA,EAAE,EAAE;AAAN,OAFiB,EAGjB,oBAHiB,CAAnB;;AAMA,UAAI,MAAKkB,wBAAL,EAAJ,EAAqC;AACnCO,QAAAA,YAAY,GAAGpC,KAAK,CAACqC,aAAN,CACb,GADa,EAEb;AAAE1B,UAAAA,EAAE,EAAE;AAAN,SAFa,EAGb,sBAAsB,MAAK2B,YAAL,EAHT,CAAf;AAKD;;AACD,aAAOF,YAAP;AACD,KAjGkB;;AAAA,UAmGnBE,YAnGmB,GAmGJ,YAAM;AACnB,UAAI,MAAKC,WAAL,EAAJ,EAAwB;AACtB,YAAMC,aAAa,GAAG,MAAKT,KAAL,CAAWS,aAAjC;AACA,YAAMC,aAAa,GAAGD,aAAa,CAAC,MAAKT,KAAL,CAAWC,gBAAZ,CAAnC;AACA,eAAOS,aAAa,CAACb,OAAd,CAAsB,CAAtB,CAAP;AACD;;AACD,aAAO,CAAP;AACD,KA1GkB;;AAAA,UA4GnBW,WA5GmB,GA4GL,YAAM;AAClB,UAAMG,QAAQ,GAAG,MAAKX,KAAL,CAAWC,gBAA5B;AACA,UAAMQ,aAAa,GAAG,MAAKT,KAAL,CAAWS,aAAjC;AACA,aAAOA,aAAa,CAACG,cAAd,CAA6BD,QAA7B,CAAP;AACD,KAhHkB;;AAAA,UAkHnBE,mBAlHmB,GAkHG,YAAM;AAC1B,UAAMnB,QAAQ,GAAG,MAAKH,iBAAL,EAAjB;;AACA,UAAI,MAAKO,wBAAL,EAAJ,EAAqC;AACnC,cAAKM,mBAAL;;AACA,eAAO,CAACV,QAAQ,GAAG,MAAKa,YAAL,EAAZ,EAAiCV,OAAjC,CAAyC,CAAzC,CAAP;AACD;;AACD,aAAOH,QAAP;AACD,KAzHkB;;AAAA,UA2HnBoB,iBA3HmB,GA2HC,UAAAC,KAAK,EAAI;AAC3B,YAAKC,QAAL,CAAc;AAAEf,QAAAA,gBAAgB,EAAEc,KAAK,CAACE,MAAN,CAAaC;AAAjC,OAAd;AACD,KA7HkB;;AAAA,UA+HnBC,gBA/HmB,GA+HA,UAAAJ,KAAK,EAAI;AAC1BA,MAAAA,KAAK,CAACK,cAAN;AACD,KAjIkB;;AAAA,UA8InBC,mBA9ImB,GA8IG,UAAAN,KAAK,EAAI;AAC7BO,MAAAA,KAAK,CAAC,mEAAD,CAAL;AACD,KAhJkB;;AAAA,UAkJnBC,sBAlJmB,GAkJM,YAAM;AAC7B,UACE,MAAKvB,KAAL,CAAWC,gBAAX,KAAgC,IAAhC,IACA,MAAKD,KAAL,CAAWC,gBAAX,KAAgC,EAFlC,EAGE;AACA;AACD;;AACD,UAAMuB,IAAI,GAAG,MAAKC,eAAL,CAAqBC,OAAlC;;AACA,UAAI,MAAK5B,wBAAL,EAAJ,EAAqC;AACnC0B,QAAAA,IAAI,CAACG,YAAL,CAAkB,OAAlB,EAA2B,oBAA3B;;AACA,YAAMC,QAAO,GAAG3D,KAAK,CAACqC,aAAN,CACd,GADc,EAEd;AAAE1B,UAAAA,EAAE,EAAE;AAAN,SAFc,EAGd,qCAHc,CAAhB;;AAKA,eAAOgD,QAAP;AACD;;AACDJ,MAAAA,IAAI,CAACG,YAAL,CAAkB,OAAlB,EAA2B,kBAA3B;AACA,UAAMC,OAAO,GAAG3D,KAAK,CAACqC,aAAN,CACd,GADc,EAEd;AAAE1B,QAAAA,EAAE,EAAE;AAAN,OAFc,EAGd,+DAHc,CAAhB;AAKA,aAAOgD,OAAP;AACD,KA1KkB;;AAEjB,UAAK5B,KAAL,GAAa;AACXC,MAAAA,gBAAgB,EAAE,IADP;AAEXQ,MAAAA,aAAa,EAAE;AACb,gBAAQ,GADK;AAEb,mBAAW,IAFE;AAGb,mBAAW;AAHE;AAFJ,KAAb;AAQA,UAAKgB,eAAL,GAAuBxD,KAAK,CAAC4D,SAAN,EAAvB;AACA,UAAKC,SAAL,GAAiB7D,KAAK,CAAC4D,SAAN,EAAjB;AACA,UAAKnB,aAAL,GAAqBzC,KAAK,CAAC4D,SAAN,EAArB;AAZiB;AAalB;;;;yCAEoB;AACnB,WAAKN,sBAAL;AACD;;;6BA2JQ;AAAA;;AACP,UAAMhD,IAAI,GAAG,KAAKF,OAAL,EAAb;AACA,UAAI0D,gBAAJ;;AACA,UAAI,CAACxD,IAAL,EAAW;AACTwD,QAAAA,gBAAgB,GAAG,IAAnB;AACD,OAFD,MAEO;AACLA,QAAAA,gBAAgB,GAAGxD,IAAI,CAACyD,GAAL,CAAS,UAAA5C,IAAI,EAAI;AAClC,iBACE;AAAK,YAAA,SAAS,EAAC,YAAf;AAA4B,YAAA,GAAG,EAAEA,IAAI,CAACR,EAAtC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,aACE,oBAAC,QAAD;AACE,YAAA,GAAG,EAAEQ,IAAI,CAACR,EADZ;AAEE,YAAA,EAAE,EAAEQ,IAAI,CAACR,EAFX;AAGE,YAAA,KAAK,EAAEQ,IAAI,CAACP,KAHd;AAIE,YAAA,IAAI,EAAEO,IAAI,CAACN,IAJb;AAKE,YAAA,KAAK,EAAEM,IAAI,CAACL,KALd;AAME,YAAA,aAAa,EAAEK,IAAI,CAACH,aANtB;AAOE,YAAA,aAAa,EAAEG,IAAI,CAACX,aAPtB;AAQE,YAAA,WAAW,EAAE,qBAAAG,EAAE;AAAA,qBAAI,MAAI,CAACR,KAAL,CAAW6D,WAAX,CAAuB7C,IAAI,CAACR,EAA5B,CAAJ;AAAA,aARjB;AASE,YAAA,WAAW,EAAE,qBAAAA,EAAE;AAAA,qBAAI,MAAI,CAACR,KAAL,CAAW8D,WAAX,CAAuB9C,IAAI,CAACR,EAA5B,CAAJ;AAAA,aATjB;AAUE,YAAA,QAAQ,EAAE,kBAAAA,EAAE;AAAA,qBAAI,MAAI,CAACR,KAAL,CAAW+D,QAAX,CAAoB/C,IAAI,CAACR,EAAzB,CAAJ;AAAA,aAVd;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,YADF,CADF;AAgBD,SAjBkB,CAAnB;AAkBD;;AACD,aACE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SACE;AAAK,QAAA,SAAS,EAAC,aAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SACE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SACE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SACE;AAAG,QAAA,SAAS,EAAC,iBAAb;AAA+B,QAAA,IAAI,EAAC,YAApC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QADF,CADF,kBADF,CADF,EASE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SAAMmD,gBAAN,CATF,EAUE;AAAK,QAAA,SAAS,EAAC,gBAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SACE;AAAK,QAAA,SAAS,EAAC,iBAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SACE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QADF,EAEE;AAAK,QAAA,IAAI,EAAC,UAAV;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SACG,gBAAgB,KAAKxC,iBAAL,EADnB,CAFF,EAKE;AAAK,QAAA,IAAI,EAAC,gBAAV;AAA2B,QAAA,GAAG,EAAE,KAAKmB,aAArC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SACG,KAAKN,mBAAL,EADH,CALF,CADF,EAUE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SACE;AAAM,QAAA,SAAS,EAAC,SAAhB;AAA0B,QAAA,QAAQ,EAAE,KAAKe,gBAAzC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SACE;AAAK,QAAA,SAAS,EAAC,cAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SACE;AAAK,QAAA,SAAS,EAAC,eAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SACE;AAAK,QAAA,SAAS,EAAC,OAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SACE;AACE,QAAA,IAAI,EAAC,MADP;AAEE,QAAA,IAAI,EAAC,eAFP;AAGE,QAAA,WAAW,EAAC,eAHd;AAIE,QAAA,IAAI,EAAC,eAJP;AAKE,QAAA,QAAQ,EAAE,KAAKL,iBALjB;AAME,QAAA,GAAG,EAAE,KAAKgB,SANZ;AAOE,QAAA,QAAQ,MAPV;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QADF,CADF,EAYE;AAAK,QAAA,SAAS,EAAC,oBAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SACE;AAAQ,QAAA,SAAS,EAAC,WAAlB;AAA8B,QAAA,IAAI,EAAC,QAAnC;AAA4C,QAAA,IAAI,EAAC,QAAjD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBADF,CAZF,CADF,CADF,CADF,EAuBE;AACE,QAAA,SAAS,EAAC,kBADZ;AAEE,QAAA,GAAG,EAAE,KAAKL,eAFZ;AAGE,QAAA,IAAI,EAAC,OAHP;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SAKG,KAAKF,sBAAL,EALH,CAvBF,EA8BE;AAAK,QAAA,IAAI,EAAC,aAAV;AAAwB,QAAA,SAAS,EAAC,aAAlC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SACG,mBAAmB,KAAKV,mBAAL,EADtB,CA9BF,EAiCE;AACE,QAAA,SAAS,EAAC,gDADZ;AAEE,QAAA,IAAI,EAAC,QAFP;AAGE,QAAA,OAAO,EAAE,KAAKQ,mBAHhB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,+BAjCF,CAVF,CAVF,CADF;AAiED;;;;EAvQ+BpD,KAAK,CAACmE,S;;SAAnBjE,I","sourcesContent":["import React from \"react\";\nimport CartItem from \"./CartItem\";\nimport \"./Cart.css\";\n\nexport default class Cart extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      userDiscountCode: null,\n      discountCodes: {\n        \"5OFF\": 5.0,\n        \"10OFF50\": 10.0,\n        \"15OFF75\": 15.0\n      }\n    };\n    this.discountMessage = React.createRef();\n    this.textInput = React.createRef();\n    this.discountValue = React.createRef();\n  }\n\n  componentDidUpdate() {\n    this.displayDiscountMessage();\n  }\n\n  getData = () => {\n    let dataToShow = [];\n    const data = this.props.data;\n    data.forEach(data => {\n      if (data.cart_quantity > 0) {\n        dataToShow.push({\n          key: data.id,\n          id: data.id,\n          image: data.image,\n          name: data.name,\n          price: data.price,\n          category: data.category,\n          shop_quantity: data.shop_quantity,\n          cart_quantity: data.cart_quantity\n        });\n      } else {\n        return null;\n      }\n    });\n    return dataToShow;\n  };\n\n  doesCartContainFootwear = () => {\n    const data = this.getData();\n    let containsFootwear = false;\n\n    data.forEach(item => {\n      let itemCategory = item.category;\n\n      if (itemCategory.includes(\"Footwear\")) {\n        containsFootwear = true;\n      }\n    });\n    return containsFootwear;\n  };\n\n  calculateSubtotal = () => {\n    const data = this.getData();\n    if (data.length === 0) {\n      return null;\n    }\n    const orderTotal = [];\n    data.forEach(data => {\n      orderTotal.push(data.price * data.cart_quantity);\n    });\n    const subtotal = orderTotal.reduce((total, price) => total + price);\n    return subtotal.toFixed(2);\n  };\n\n  areDiscountConditionsMet = () => {\n    const subtotal = this.calculateSubtotal();\n    const five = this.state.userDiscountCode === \"5OFF\";\n    const ten = this.state.userDiscountCode === \"10OFF50\" && subtotal > 50;\n    const fifteen =\n      this.state.userDiscountCode === \"15OFF75\" &&\n      subtotal > 75 &&\n      this.doesCartContainFootwear();\n    if (five || ten || fifteen) {\n      return true;\n    }\n    return false;\n  };\n\n  displayDiscountInfo = () => {\n    let discountInfo = React.createElement(\n      \"p\",\n      { id: \"discount-info\" },\n      \"Discount value: £0\"\n    );\n\n    if (this.areDiscountConditionsMet()) {\n      discountInfo = React.createElement(\n        \"p\",\n        { id: \"discount-info\" },\n        \"Discount value: £\" + this.getCodeValue()\n      );\n    }\n    return discountInfo;\n  };\n\n  getCodeValue = () => {\n    if (this.isCodeValid()) {\n      const discountCodes = this.state.discountCodes;\n      const discountValue = discountCodes[this.state.userDiscountCode];\n      return discountValue.toFixed(2);\n    }\n    return 0;\n  };\n\n  isCodeValid = () => {\n    const userCode = this.state.userDiscountCode;\n    const discountCodes = this.state.discountCodes;\n    return discountCodes.hasOwnProperty(userCode);\n  };\n\n  calculateOrderTotal = () => {\n    const subtotal = this.calculateSubtotal();\n    if (this.areDiscountConditionsMet()) {\n      this.displayDiscountInfo();\n      return (subtotal - this.getCodeValue()).toFixed(2);\n    }\n    return subtotal;\n  };\n\n  handleInputChange = event => {\n    this.setState({ userDiscountCode: event.target.value });\n  };\n\n  handleFormSubmit = event => {\n    event.preventDefault();\n  };\n\n  // handleKeyPress = event => {\n  //   if (event.key === \"Enter\") {\n  //     this.setState({ userDiscountCode: event.target.value });\n  //   }\n  // };\n\n  // handleSubmit = event => {\n  //   event.preventDefault();\n  //   this.setState({ userDiscountCode: this.textInput.current.value });\n  // };\n\n  handleCheckoutClick = event => {\n    alert(\"Thanks for ordering from Nutmeg! Your items will be with you soon\");\n  };\n\n  displayDiscountMessage = () => {\n    if (\n      this.state.userDiscountCode === null ||\n      this.state.userDiscountCode === \"\"\n    ) {\n      return;\n    }\n    const node = this.discountMessage.current;\n    if (this.areDiscountConditionsMet()) {\n      node.setAttribute(\"class\", \"ui success message\");\n      const message = React.createElement(\n        \"p\",\n        { id: \"success\" },\n        \"Success! Your code has been applied\"\n      );\n      return message;\n    }\n    node.setAttribute(\"class\", \"ui error message\");\n    const message = React.createElement(\n      \"p\",\n      { id: \"error\" },\n      \"Invalid discount code or conditions not met. Please try again\"\n    );\n    return message;\n  };\n\n  render() {\n    const data = this.getData();\n    let displayCartItems;\n    if (!data) {\n      displayCartItems = null;\n    } else {\n      displayCartItems = data.map(item => {\n        return (\n          <div className=\"cart-items\" key={item.id}>\n            <CartItem\n              key={item.id}\n              id={item.id}\n              image={item.image}\n              name={item.name}\n              price={item.price}\n              shop_quantity={item.shop_quantity}\n              cart_quantity={item.cart_quantity}\n              onIncrement={id => this.props.onIncrement(item.id)}\n              onDecrement={id => this.props.onDecrement(item.id)}\n              onRemove={id => this.props.onRemove(item.id)}\n            />\n          </div>\n        );\n      });\n    }\n    return (\n      <div>\n        <div className=\"cart-header\">\n          <p>\n            <span>\n              <i className=\"shop icon small\" test=\"icon-image\" />\n            </span>\n            Shopping Cart\n          </p>\n        </div>\n        <div>{displayCartItems}</div>\n        <div className=\"total-for-cart\">\n          <div className=\"cart-total-text\">\n            <hr />\n            <div test=\"subtotal\">\n              {\"Subtotal: £\" + this.calculateSubtotal()}\n            </div>\n            <div test=\"discount-value\" ref={this.discountValue}>\n              {this.displayDiscountInfo()}\n            </div>\n          </div>\n          <div>\n            <form className=\"ui form\" onSubmit={this.handleFormSubmit}>\n              <div className=\"inline field\">\n                <div className=\"inline fields\">\n                  <div className=\"field\">\n                    <input\n                      type=\"text\"\n                      name=\"discount-code\"\n                      placeholder=\"Discount code\"\n                      test=\"discount-code\"\n                      onChange={this.handleInputChange}\n                      ref={this.textInput}\n                      required\n                    />\n                  </div>\n                  <div className=\"field button-field\">\n                    <button className=\"ui button\" type=\"submit\" test=\"submit\">\n                      Submit\n                    </button>\n                  </div>\n                </div>\n              </div>\n            </form>\n            <div\n              className=\"discount-message\"\n              ref={this.discountMessage}\n              test=\"alert\"\n            >\n              {this.displayDiscountMessage()}\n            </div>\n            <div test=\"order-total\" className=\"order-total\">\n              {\"Order total: £\" + this.calculateOrderTotal()}\n            </div>\n            <button\n              className=\"ui yellow right floated button checkout-button\"\n              type=\"button\"\n              onClick={this.handleCheckoutClick}\n            >\n              PROCEED TO CHECKOUT\n            </button>\n          </div>\n        </div>\n      </div>\n    );\n  }\n}\n"]},"metadata":{},"sourceType":"module"}